<html ng-app="bubblot">
<head>
    <meta charset="utf-8">
    <title>Bubblot NW</title>
    <meta name="viewport" content="initial-scale=2, maximum-scale=2, user-scalable=no, width=device-width">
    <link href="css/main.css" rel="stylesheet">

    <script type="text/javascript" src="js/yocto_api.js"></script>
    <script type="text/javascript" src="js/yocto_tilt.js"></script>
    <script type="text/javascript" src="js/yocto_compass.js"></script>
    <script type="text/javascript" src="js/yocto_accelerometer.js"></script>
    <script type="text/javascript" src="js/yocto_gps.js"></script>
    <script type="text/javascript" src="js/yocto_servo.js"></script>
    <script type="text/javascript" src="js/yocto_colorled.js"></script>
    <script type="text/javascript" src="js/yocto_colorledcluster.js"></script>
    <script type="text/javascript" src="js/yocto_temperature.js"></script>
    <script type="text/javascript" src="js/yocto_anbutton.js"></script>
    <script type="text/javascript" src="js/yocto_relay.js"></script>
    <script type="text/javascript" src="js/yocto_pwmoutput.js"></script>
    <script type="text/javascript" src="js/yocto_pwminput.js"></script>
    <script type="text/javascript" src="js/yocto_digitalio.js"></script>
    <script type="text/javascript" src="js/yocto_datalogger.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/circle-progress.js"></script>
    <script type="text/javascript" src="js/chart.js"></script>
    <script type="text/javascript" src="js/shortcut.js"></script>

    <script>
        if (typeof require != 'undefined') {
            require("ws");
            var module3dconnexion = require('vrviewer');
            var fs = require('fs');
            var recordRTC = require('recordrtc');
            var SerialPort = require('serialport');
            var NodeCouchDb = require('node-couchdb');
        }
    </script>

    <script>
        function show(shown, hidden) {
            document.getElementById(hidden).style.display='none';
            document.getElementById(shown).style.display='block';
        return false;
        }
    </script>

</head>
 
<body ng-controller="mainController as vm" style="background-color:rgba(0,0,0,0);">

<!-- Audio winder ALERT -->
<audio src="img/audioAlert.wav" id="audio-alert-winder" loop></audio>
<!-- Audio bubblot ALERT -->
<audio src="img/audioAlert4.wav" id="audio-alert-bubblot" loop></audio>
<!-- Audio pump ALERT -->
<audio src="img/audioAlert4.wav" id="audio-alert-pump" loop></audio>

<!-- Bubblot display -->
<div id="bubblotDisplay">
    <video src="img/video.webm" class="camera-bubblot" autoplay style="width:100%;height:100%;z-index: -10" loop></video>
    <!-- Background video for presentation -->
    <video src="img/video.webm" class="video-background" style="position: fixed; top:-100%; left:-50%; width:200%; height: 200%; display:none;"autoplay loop></video>
    <div id="fond-marin" class="fond-marin">
        <!-- Cadrans de gauche -->  
        <left-side data="leftData"></left-side>
        <!-- Cadrans de droite -->
        <right-side data="rightData"></right-side>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot disable" href="#">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump" href="#" onclick="return show('pumpDisplay','bubblotDisplay');">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder" href="#" onclick="return show('winderDisplay','bubblotDisplay');">Winders</a>
        <!-- display map -->
        <a class="btn-map" href="#" onclick="return show('mapDisplay','bubblotDisplay');">Map</a>
    </div>

    <div id="fond-marin2" class="fond-marin2">
        <!-- Cadrans de gauche -->
        <left-side data="leftData"></left-side>
        <!-- Cadrans de droite -->
        <right-side data="rightData"></right-side>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot disable" href="#">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump" href="#" onclick="return show('pumpDisplay','bubblotDisplay');">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder" href="#" onclick="return show('winderDisplay','bubblotDisplay');">Winders</a>
        <!-- display map -->
        <a class="btn-map" href="#" onclick="return show('mapDisplay','bubblotDisplay');">Map</a>
    </div>
</div>

<!-- Pump display -->
<div id="pumpDisplay" style="display:none;overflow:hidden">
    <video src="img/video.webm" class="camera-pump" autoplay style="width:100%;height:100%;z-index: -10" loop></video>
    <div id="fond-marin" class="fond-marin">
        <!-- Camera view -->
        <video class="camera-pump1" autoplay loop></video>
        <!-- Background image for demo -->
        <img src="img/fondPumpDemo.jpg" style="width:100%;height:100%;z-index: -10"></img>
        <!-- Cadrans de gauche -->
        <left-side-pump data="leftDataPump"></left-side-pump>
        <!-- Cadrans de droite -->
        <right-side-pump data="rightDataPump"></right-side-pump>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot" href="#" onclick="return show('bubblotDisplay','pumpDisplay');">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump disable" href="#">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder" href="#" onclick="return show('winderDisplay','pumpDisplay');">Winders</a>
        <!-- display map -->
        <a class="btn-map" href="#" onclick="return show('mapDisplay','pumpDisplay');">Map</a>
    </div>

    <div id="fond-marin2" class="fond-marin2">
        <!-- Camera view -->
        <video class="camera-pump2" autoplay loop></video>
        <!-- Background image for demo -->
        <img src="img/fondPumpDemo.jpg" style="width:100%;height:100%;z-index: -10"></img>
        <!-- Cadrans de gauche -->
        <left-side-pump data="leftDataPump"></left-side-pump>
        <!-- Cadrans de droite -->
        <right-side-pump data="rightDataPump"></right-side-pump>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot" href="#" onclick="return show('bubblotDisplay','pumpDisplay');">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump disable" href="#">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder" href="#" onclick="return show('winderDisplay','pumpDisplay');">Winders</a>
        <!-- display map -->
        <a class="btn-map" href="#" onclick="return show('mapDisplay','pumpDisplay');">Map</a>
    </div>
</div>

<!-- Cable winder display -->
<div id="winderDisplay" style="display:none;overflow:hidden">
    <div id="fond-marin" class="fond-marin">
        <!-- Camera view -->
        <video class="camera-winder1" autoplay loop></video>
        <!-- Background image for demo -->
        <img src="img/fondWinderDemo.jpg" style="width:100%;height:100%;z-index: -10"></img>
        <!-- Cadrans cable winder -->
        <cable-winder data="winderData"></cable-winder>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot" href="#" onclick="return show('bubblotDisplay','winderDisplay');">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump" href="#" onclick="return show('pumpDisplay','winderDisplay');">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder disable" href="#">Winders</a>
        <!-- display map -->
        <a class="btn-map" href="#" onclick="return show('mapDisplay','winderDisplay');">Map</a>
    </div>

    <div id="fond-marin2" class="fond-marin2">
        <!-- Camera view -->
        <video class="camera-winder2" autoplay loop></video>
        <!-- Background image for demo -->
        <img src="img/fondWinderDemo.jpg" style="width:100%;height:100%;z-index: -10"></img>
        <!-- Cadrans cable winder -->
        <cable-winder data="winderData"></cable-winder>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot" href="#" onclick="return show('bubblotDisplay','winderDisplay');">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump" href="#" onclick="return show('pumpDisplay','winderDisplay');">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder disable" href="#">Winders</a>
        <!-- display map -->
        <a class="btn-map" href="#" onclick="return show('mapDisplay','winderDisplay');">Map</a>
    </div>
</div>

<!-- Map display -->
<div id="mapDisplay" style="display:none;overflow:hidden">
    <div id="fond-marin" class="fond-marin">
        <!-- Map -->
        <map data="mapData"></map>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot" href="#" onclick="return show('bubblotDisplay','mapDisplay');">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump" href="#" onclick="return show('pumpDisplay','mapDisplay');">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder" href="#" onclick="return show('winderDisplay','mapDisplay');">Winders</a>
        <!-- display map -->
        <a class="btn-map disable" href="#">Map</a>
    </div>
    <div id="fond-marin2" class="fond-marin2" style="display:block">
        <!-- Map -->
        <map data="mapData"></map>
        <!-- Notifications -->
        <notification data="notifData"></notification>
        <!-- display bubblot -->
        <a class="btn-bubblot" href="#" onclick="return show('bubblotDisplay','mapDisplay');">Bubblot</a>
        <!-- display pump -->
        <a class="btn-pump" href="#" onclick="return show('pumpDisplay','mapDisplay');">Pump</a>
        <!-- display cable winder -->
        <a class="btn-winder" href="#" onclick="return show('winderDisplay','mapDisplay');">Winders</a>
        <!-- display map -->
        <a class="btn-map disable" href="#">Map</a>
    </div>
</div>

<!-- Shortcuts -->
<script>
    //Bubblot display
    shortcut.add("alt+1", function() {
        if ($('#pumpDisplay').is(':visible')) {
            return show('bubblotDisplay','pumpDisplay');
        }
        if ($('#winderDisplay').is(':visible')) {
            return show('bubblotDisplay','winderDisplay');
        } 
        if ($('#mapDisplay').is(':visible')) {
            return show('bubblotDisplay','mapDisplay');
        }        
    }); 
    //Pump display
    shortcut.add("alt+2", function() {
        if ($('#bubblotDisplay').is(':visible')) {
            return show('pumpDisplay','bubblotDisplay');
        }
        if ($('#winderDisplay').is(':visible')) {
            return show('pumpDisplay','winderDisplay');
        }  
        if ($('#mapDisplay').is(':visible')) {
            return show('pumpDisplay','mapDisplay');
        }       
    }); 
    //Winder display
    shortcut.add("alt+3", function() {
        if ($('#bubblotDisplay').is(':visible')) {
            return show('winderDisplay','bubblotDisplay');
        }
        if ($('#pumpDisplay').is(':visible')) {
            return show('winderDisplay','pumpDisplay');
        } 
        if ($('#mapDisplay').is(':visible')) {
            return show('winderDisplay','mapDisplay');
        }        
    });
    //Map display
    shortcut.add("alt+4", function() {
        if ($('#bubblotDisplay').is(':visible')) {
            return show('mapDisplay','bubblotDisplay');
        }
        if ($('#pumpDisplay').is(':visible')) {
            return show('mapDisplay','pumpDisplay');
        }        
        if ($('#winderDisplay').is(':visible')) {
            return show('mapDisplay','winderDisplay');
        } 
    });
    //Presentation mode
    shortcut.add("ctrl+2", function() {
        var cameraPump=document.getElementsByClassName('camera-pump');
        var cameraBubblot=document.getElementsByClassName('camera-bubblot');
        var videoBackground = document.getElementsByClassName('video-background');
        var fondMarin= document.getElementsByClassName('fond-marin');
        var fondMarin2= document.getElementsByClassName('fond-marin2');
        for(var i=0; i < cameraPump.length; i++){
            cameraPump[i].style.display='none';
        }
        for(var i=0; i < cameraBubblot.length; i++){
            cameraBubblot[i].style.display='none';
        }
        for(var i=0; i < fondMarin2.length; i++){
            fondMarin2[i].style.display='none';
        }
        for(var i=0; i < videoBackground.length; i++){
            videoBackground[i].style.display='block';
        }
        for(var i=0; i < fondMarin.length; i++){
            fondMarin[i].style="transform: scale3d(1,1,1) translate3d(0, 0, 0);";
        }

    });
    //3D mode
    shortcut.add("ctrl+3", function() {
        var cameraPump=document.getElementsByClassName('camera-pump');
        var cameraBubblot=document.getElementsByClassName('camera-bubblot');
        var videoBackground = document.getElementsByClassName('video-background');
        var fondMarin= document.getElementsByClassName('fond-marin');
        var fondMarin2= document.getElementsByClassName('fond-marin2');
        for(var i=0; i < videoBackground.length; i++){
            videoBackground[i].style.display='none';
        }
        for(var i=0; i < cameraPump.length; i++){
            cameraPump[i].style.display='block';
        }
        for(var i=0; i < cameraBubblot.length; i++){
            cameraBubblot[i].style.display='block';
        }
        for(var i=0; i < fondMarin2.length; i++){
            fondMarin2[i].style.display='block';
        }
        for(var i=0; i < fondMarin.length; i++){
            fondMarin[i].style="transform: scale3d(1,0.5, 1) translate3d(0, -50%, 0);";
        }
    });
</script>

<!-- Display and choose the media devices -->
    <script>
        MediaStreamTrack.getSources(function(sourceInfos) {
            var audioSource = null;
            var videoSource = null;

            for (var i = 0; i != sourceInfos.length; ++i) {
                var sourceInfo = sourceInfos[i];
                if (sourceInfo.kind === 'audio') {
                console.log(sourceInfo.id, sourceInfo.label || 'microphone');

                audioSource = sourceInfo.id;
                } else if (sourceInfo.kind === 'video') {
                console.log(sourceInfo.id, sourceInfo.label || 'camera');

                videoSource = sourceInfo.id;
                } else {
                console.log('Some other kind of source: ', sourceInfo);
                }
            }
        });
        //var video = document.getElementsByClassName('camera-pump'),
        vendorURL = window.URL || window.webkitURL;

        navigator.getMedia = navigator.getUserMedia ||
                            navigator.webkitGetUserMedia ||
                            navigator.mozWetUserMedia ||
                            navigator.msGetUserMedia;

        function successCallback(stream) {
            var options = {
                mimeType: 'video/webm',
                bitsPerSecond: 128000
            };
            video[0].src = vendorURL.createObjectURL(stream);
            video[1].src = vendorURL.createObjectURL(stream);
            video[2].src = vendorURL.createObjectURL(stream);
            video[3].src = vendorURL.createObjectURL(stream);
        }
        
        function errorCallback(error) {
            console.log("No cam detected, maybe another application is using the device"); 
        }
        
        var mediaConstraints = {
            audio: false,
            video: {
                optional: [{sourceId: "42094d72e42b19bac96892fbb06e6d87343591b564c2098fa06d4a9e862cb600"}]
            }
        };
        
        //navigator.getMedia(mediaConstraints, successCallback, errorCallback);
    </script>

<script src="node_modules/angular/angular.js"></script>
<script src="js/main.js"></script>
<script src="js/directives/circle-progress/circle-progress.js"></script>
<script src="js/directives/horizon/horizon.controller.js"></script>
<script src="js/directives/horizon/horizon.js"></script>
<script src="js/directives/camera/camera.controller.js"></script>
<script src="js/directives/camera/camera.js"></script>
<script src="js/directives/thrust/thrust.controller.js"></script>
<script src="js/directives/thrust/thrust.js"></script>
<script src="js/directives/direction/direction.controller.js"></script>
<script src="js/directives/direction/direction.js"></script>
<script src="js/directives/draggable/draggable.js"></script>
<script src="js/directives/drag-circle/drag-circle.js"></script>
<script src="js/directives/drag-3d-view/drag-3d-view.js"></script>
<script src="js/directives/drag-direction/drag-direction.js"></script>
<script src="js/directives/3d-view/3d-view.controller.js"></script>
<script src="js/directives/3d-view/3d-view.js"></script>
<script src="js/directives/noze/noze.js"></script>
<script src="js/directives/noze/noze.controller.js"></script>
<script src="js/directives/deep/deep.js"></script>
<script src="js/directives/deep/deep.controller.js"></script>
<script src="js/directives/lighting/lighting.js"></script>
<script src="js/directives/lighting/lighting.controller.js"></script>
<script src="js/directives/storage/storage.js"></script>
<script src="js/directives/storage/storage.controller.js"></script>
<script src="js/directives/graph/graph.js"></script>
<script src="js/directives/graph/graph.controller.js"></script>
<script src="js/directives/left-side/left-side.controller.js"></script>
<script src="js/directives/left-side/left-side.js"></script>
<script src="js/directives/right-side/right-side.controller.js"></script>
<script src="js/directives/right-side/right-side.js"></script>
<script src="js/directives/pump-gps/pump-gps.js"></script>
<script src="js/directives/pump-gps/pump-gps.controller.js"></script>
<script src="js/directives/pump-power/pump-power.js"></script>
<script src="js/directives/pump-power/pump-power.controller.js"></script>
<script src="js/directives/pump-horizon/pump-horizon.controller.js"></script>
<script src="js/directives/pump-horizon/pump-horizon.js"></script>
<script src="js/directives/pump-deep/pump-deep.js"></script>
<script src="js/directives/pump-deep/pump-deep.controller.js"></script>
<script src="js/directives/pump-direction/pump-direction.controller.js"></script>
<script src="js/directives/pump-direction/pump-direction.js"></script>
<script src="js/directives/left-side-pump/left-side-pump.controller.js"></script>
<script src="js/directives/left-side-pump/left-side-pump.js"></script>
<script src="js/directives/right-side-pump/right-side-pump.controller.js"></script>
<script src="js/directives/right-side-pump/right-side-pump.js"></script>
<script src="js/directives/winder-control/winder-control.js"></script>
<script src="js/directives/winder-control/winder-control.controller.js"></script>
<script src="js/directives/drag-winder/drag-winder.js"></script>
<script src="js/directives/drag-main-winder/drag-main-winder.js"></script>
<script src="js/directives/winder-panel1/winder-panel1.js"></script>
<script src="js/directives/winder-panel1/winder-panel1.controller.js"></script>
<script src="js/directives/winder-panel2/winder-panel2.js"></script>
<script src="js/directives/winder-panel2/winder-panel2.controller.js"></script>
<script src="js/directives/winder-panel3/winder-panel3.js"></script>
<script src="js/directives/winder-panel3/winder-panel3.controller.js"></script>
<script src="js/directives/winder-panel4/winder-panel4.js"></script>
<script src="js/directives/winder-panel4/winder-panel4.controller.js"></script>
<script src="js/directives/cable-winder/cable-winder.controller.js"></script>
<script src="js/directives/cable-winder/cable-winder.js"></script>
<script src="js/directives/notification/notification.controller.js"></script>
<script src="js/directives/notification/notification.js"></script>
<script src="js/directives/bubblot-alert/bubblot-alert.controller.js"></script>
<script src="js/directives/bubblot-alert/bubblot-alert.js"></script>
<script src="js/directives/pump-alert/pump-alert.controller.js"></script>
<script src="js/directives/pump-alert/pump-alert.js"></script>
<script src="js/directives/winder-alert/winder-alert.controller.js"></script>
<script src="js/directives/winder-alert/winder-alert.js"></script>
<script src="js/directives/map-map/map-map.controller.js"></script>
<script src="js/directives/map-map/map-map.js"></script>
<script src="js/directives/map-panel/map-panel.controller.js"></script>
<script src="js/directives/map-panel/map-panel.js"></script>
<script src="js/directives/map/map.controller.js"></script>
<script src="js/directives/map/map.js"></script>

</body>
</html>
